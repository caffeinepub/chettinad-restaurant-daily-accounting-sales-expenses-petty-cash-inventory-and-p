{
  "kind": "build_request",
  "title": "Add Fixed vs Variable classification for Expenses (entry, filtering, and reporting)",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-15",
      "text": "Extend the ExpenseEntry data model to include an expense classification field that distinguishes Fixed expenses from Variable expenses, and expose this field through the backend API used by the frontend.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Inside i need a fixed expenses and variable expenses"
        ]
      },
      "acceptanceCriteria": [
        "Backend defines an ExpenseType (or equivalent) with exactly two values: Fixed and Variable.",
        "ExpenseEntry includes the new classification field and it is returned by getAllExpenseEntries/getExpenseEntry.",
        "createExpenseEntry and updateExpenseEntry accept the classification field and persist it with the entry.",
        "Existing expense entries created before this change continue to load without trapping; a clear default classification is applied to legacy entries during upgrade/migration if needed."
      ]
    },
    {
      "id": "REQ-16",
      "text": "Update the Expenses UI to allow selecting Fixed vs Variable when creating or editing an expense, and display the classification in the expense entries list.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Inside i need a fixed expenses and variable expenses"
        ]
      },
      "acceptanceCriteria": [
        "In the Add Expense / Edit Expense dialog, a required input allows choosing between Fixed and Variable.",
        "When an expense is saved, the selected classification is sent to the backend and is preserved when reloading the list.",
        "The expense entries table shows each expense’s classification (e.g., a badge or column) using English labels “Fixed” and “Variable”.",
        "All user-facing text added for this feature is in English."
      ]
    },
    {
      "id": "REQ-17",
      "text": "Add filtering in the Expenses page to view All expenses, only Fixed expenses, or only Variable expenses, applying the filter in the existing filters area corresponding to the selected element (/html/body/div/div/main/div/div[2]/div[2]/div[1]/div[2]).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Inside i need a fixed expenses and variable expenses"
        ]
      },
      "acceptanceCriteria": [
        "The Expenses filter area includes a new filter control for expense classification with options: All, Fixed, Variable.",
        "Selecting Fixed shows only fixed-classified expenses; selecting Variable shows only variable-classified expenses; selecting All shows both.",
        "“Clear Filters” resets the classification filter back to All (along with the existing date/category filters)."
      ]
    },
    {
      "id": "REQ-18",
      "text": "Update Profit & Loss reporting calculations to compute and show totals for Fixed expenses and Variable expenses for the selected date range.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Inside i need a fixed expenses and variable expenses"
        ]
      },
      "acceptanceCriteria": [
        "When generating a report, the app computes (for the selected date range) total fixed expenses and total variable expenses in addition to total expenses.",
        "The Reports page displays the fixed vs variable totals in English in a clear summary section (format consistent with existing report cards/tables).",
        "Existing category breakdown remains available and continues to work after adding the classification field."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in backend/main.mo; do not introduce additional backend services.",
    "Only create backend/migration.mo if it is required to preserve/upgrade existing stored expense entries.",
    "Do not modify any frontend files under frontend/src/components/ui or any paths listed in frontend.immutablePaths; compose existing UI components instead.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Adding new expense categories or changing the existing category list.",
    "Adding third-party authentication or external database storage.",
    "Implementing real-time updates or notifications."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}